# Todo
- [ ] Auth service
    - [x] Implement repo for SessionRepo
    - [x] Implement relevant method for UserRepo
    - [x] Implement service for AuthService
        - [x] Register
        - [x] Login
        - [x] Logout
        - [x] Refresh
        - [x] Authenticate
    - [ ] Implement controller for AuthController
        - [x] Document Auth routes
        - [x] Green path implemented
        - [ ] Proper parsing of validator error
- [ ] Server service
    - [ ] Shape:
        - [ ] Add roles to server aggregate
    - [x] Implement repo
        - [x] Save server
            - [x] Update the change
            - [x] Add event to outbox
        - [x] Find server by id
        - [x] Find servers by ids
    - [ ] Implement service
        - [ ] Create new server
            - [x] Create server
            - [x] Add user to the server
            - [x] Create default channel
            - [ ] Create default role
        - [x] Get servers by user
        - [x] Get server by ID
            - [x] Check if user is in the server
            - [x] Return the server
            - [x] Get channels
        - [x] Get servers by IDs
        - [ ] Update server
            - [ ] Check permission
                - [x] Server ownership
                - [ ] Role
            - [x] Actual update
        - [x] Delete server
            - [x] Check permission
                - [x] Server ownership
            - [x] Delete server
        - [ ] Transfer ownership
            - [ ] Check for membership
            - [ ] Check for ownership
            - [ ] Actual transfer
    - [ ] Implement controller
        - [x] Auth middleware
        - [ ] Create new server
            - [x] Document server routes
            - [x] Create server
            - [ ] Error parsing route
        - [x] Get servers user in
            - [x] Document server routes
            - [x] Get user's servers
            - [x] Get servers
            - [x] Error parsing route
        - [x] Get server by ID
            - [x] Document server routes
            - [x] Get server
            - [x] Get channels
            - [x] Error parsing route
        - [ ] Update Server
            - [x] Document server routes
            - [x] Green path
            - [ ] Error parsing route
        - [x] Delete Server
            - [x] Document server routes
            - [x] Green path
            - [x] Error parsing route
        - [x] Get invitations
            - [x] Document server routes
            - [x] Green path
            - [x] Error parsing route
        - [ ] Create invitation
            - [x] Document server routes
            - [x] Green path
            - [ ] Error parsing route
- [ ] Invitation service
    - [x] Implement repo
        - [x] Get invitations by server id
        - [x] Get invitation by id
        - [x] Save invitation
            - [x] Update the change
            - [x] Add event to outbox
    - [x] Implement service
        - [x] Get invitations by server ID
        - [x] Get invitation by ID
        - [x] Create invitation
        - [x] Edit invitation
        - [x] Invalidate invitation
    - [ ] Implement controller
        - [x] Auth middleware
        - [x] Get invitation by ID
            - [x] Document server routes
            - [x] Get invitation
            - [x] Get server details
            - [x] Error parsing route
        - [x] Join server
            - [x] Document server routes
            - [x] Green path
            - [x] Error parsing route
        - [ ] Update invitation
            - [x] Document server routes
            - [x] Green path
            - [ ] Error parsing route
        - [x] Invalidate invitation
            - [x] Document server routes
            - [x] Green path
            - [x] Error parsing route
- [ ] Membership service
    - [ ] Shape:
        - [ ] Added role assignments to membership
    - [ ] Implement repo
        - [x] Find membership
        - [x] Find memberships by user id
        - [x] Find membership by server id
        - [ ] Find member's role assignments
        - [ ] Save membership
            - [x] Update the change
            - [ ] Add event to outbox
        - [ ] Save role for membership
    - [ ] Implement service
        - [x] Join server
        - [x] Leave server
        - [ ] Kick member
        - [ ] Ban member
        - [ ] Assign role
        - [ ] Update channel user permission
        - [ ] Get server by user in
        - [ ] Set nickname
    - [ ] Implement controller
        - [ ] Get members in a server
- [ ] Channel service
    - [ ] Shape:
        - [ ] Merge permission overwrite to channel shape
    - [ ] Implement repo
        - [ ] Find channel by id
            - [x] Fetch channel
            - [ ] Fetch overwrites
        - [ ] Find channels by ids
            - [x] Fetch channels
            - [ ] Fetch overwrites
        - [ ] Find channels by server id
            - [x] Fetch channels
            - [ ] Fetch overwrites
        - [x] Save channel
            - [x] Update the change
            - [x] Add event to outbox

        - [x] Get server max ordering

        <!-- Find override by user without channel id -->
    - [ ] Implement service
        - [x] Get channel
        - [x] Get channels by server id
        - [ ] Create channel
            - [ ] Permission check
            - [x] Create channel
        - [ ] Update channel
            - [ ] Permission check
            - [ ] Update channel
        - [ ] Delete channel
            - [ ] Permission check
            - [x] Delete channel
    - [ ] Implement controller
        - [x] Get channel
        - [x] Create channel
        - [ ] Update channel
        - [ ] Delete channel
- [ ] Message service
    - [x] Implement repo
    - [ ] Implement service
        - [ ] Get message
            - [x] Get message
            - [ ] Check permission
        - [x] Get messages by channel id
            - [x] Get messages
            - [ ] Check permission
        - [ ] Get messages by group id
        - [x] Create message
            - [x] Create message
            - [ ] Check permission
        - [ ] Edit message
        - [ ] Delete message
            - [x] Delete message
            - [ ] Check permission
    - [ ] Implement controller
        - [x] Create message controller
        - [x] Get message controller
        - [ ] Get messages by channel id controller
        - [ ] Get messages by group id controller
- [ ] Websocket service
    - [ ] Hub
        - [ ] Messages handlers
        - [ ] Servers handlers
        - [ ] Channels handlers
    - [ ] Client
        - [ ] Read pump and channel
        - [x] Write pump and channel
- [ ] Permission service
    - [ ] Check by permission bit
        - [ ] Calculate server effective bit
        - [ ] Calculate channel effective bit
        - [x] Return result
    - [ ] Get all visible channels
- [ ] Attachment service
    - [ ] Implement repo
    - [ ] Implement service
    - [ ] Implement controller
- [ ] User service
- [ ] User settings service
